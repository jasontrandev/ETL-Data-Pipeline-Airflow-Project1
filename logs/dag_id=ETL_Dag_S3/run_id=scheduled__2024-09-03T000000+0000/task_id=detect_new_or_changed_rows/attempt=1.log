[2024-09-04T14:06:29.658+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-03T00:00:00+00:00 [queued]>
[2024-09-04T14:06:29.689+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-03T00:00:00+00:00 [queued]>
[2024-09-04T14:06:29.690+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 6
[2024-09-04T14:06:29.728+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): detect_new_or_changed_rows> on 2024-09-03 00:00:00+00:00
[2024-09-04T14:06:29.738+0000] {standard_task_runner.py:60} INFO - Started process 627 to run task
[2024-09-04T14:06:29.744+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ETL_Dag_S3', 'detect_new_or_changed_rows', 'scheduled__2024-09-03T00:00:00+00:00', '--job-id', '336', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag_s3.py', '--cfg-path', '/tmp/tmpqllevmif']
[2024-09-04T14:06:29.747+0000] {standard_task_runner.py:88} INFO - Job 336: Subtask detect_new_or_changed_rows
[2024-09-04T14:06:29.829+0000] {task_command.py:423} INFO - Running <TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-03T00:00:00+00:00 [running]> on host f79655b91e76
[2024-09-04T14:06:30.006+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='jasontran' AIRFLOW_CTX_DAG_ID='ETL_Dag_S3' AIRFLOW_CTX_TASK_ID='detect_new_or_changed_rows' AIRFLOW_CTX_EXECUTION_DATE='2024-09-03T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-09-03T00:00:00+00:00'
[2024-09-04T14:06:30.054+0000] {credentials.py:1147} INFO - Found credentials in environment variables.
[2024-09-04T14:06:30.956+0000] {logging_mixin.py:188} INFO - Succesfully read data from AWS S3
[2024-09-04T14:06:30.959+0000] {connection.py:370} INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-09-04T14:06:30.961+0000] {connection.py:1171} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-09-04T14:06:34.545+0000] {logging_mixin.py:188} INFO - Connected to Snowflake DWH succesfully
[2024-09-04T14:06:34.546+0000] {cursor.py:1028} INFO - query: [select * from ***_db.tcops_dimensions.employee_dim]
[2024-09-04T14:06:35.824+0000] {cursor.py:1041} INFO - query execution done
[2024-09-04T14:06:35.830+0000] {cursor.py:1205} INFO - Number of results in first chunk: 491
[2024-09-04T14:06:35.831+0000] {logging_mixin.py:188} INFO - Query executed
[2024-09-04T14:06:37.008+0000] {logging_mixin.py:188} INFO - Data fetched
[2024-09-04T14:06:37.009+0000] {logging_mixin.py:188} INFO - Columns renamed
[2024-09-04T14:06:37.042+0000] {logging_mixin.py:188} INFO - Found 2 new rows
[2024-09-04T14:06:37.051+0000] {logging_mixin.py:188} INFO - Found 1 changed rows
[2024-09-04T14:06:37.057+0000] {python.py:201} INFO - Done. Returned value was: {'rows_to_insert': "('Tran, Nguyen Viet Han', '001868', 'jane.tran@truecommerce.com', 'Support Analyst', 'Le, Minh Tam', 'DiCentral Vietnam', 'True Commerce', '652-GS Worldwide Support', 'Ho Chi Minh City', 'TC.net - Transaction Mana', '2024-04-03', NULL, '2024-09-04', NULL, 'Y'), ('Trinh, The Duy', '001854', 'peter.t.trinh@truecommerce.com', 'Support Analyst', 'Le, Minh Tam', 'DiCentral Vietnam', 'True Commerce', '652-GS Worldwide Support', 'Ho Chi Minh City', 'TC.net - Transaction Mana', '2024-03-25', NULL, '2024-09-04', NULL, 'Y'), ('Nguyen, Thi Hang', '950018', 'fiona.nguyen@truecommerce.com', 'Technical Support', 'Le, Minh Tam', 'DiCentral Vietnam', 'DiCentral', '650-Worldwide Support', 'Ho Chi Minh City', 'DIC - CIP Platform', '2022-11-10', NULL, '2024-09-04', NULL, 'Y')", 'ids_to_update': '950018'}
[2024-09-04T14:06:37.156+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ETL_Dag_S3, task_id=detect_new_or_changed_rows, execution_date=20240903T000000, start_date=20240904T140629, end_date=20240904T140637
[2024-09-04T14:06:37.200+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-09-04T14:06:37.246+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
