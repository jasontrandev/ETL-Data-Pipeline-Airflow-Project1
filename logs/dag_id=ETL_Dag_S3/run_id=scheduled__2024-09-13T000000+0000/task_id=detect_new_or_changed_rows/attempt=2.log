[2024-09-14T15:15:19.568+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-13T00:00:00+00:00 [queued]>
[2024-09-14T15:15:19.597+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-13T00:00:00+00:00 [queued]>
[2024-09-14T15:15:19.599+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 7
[2024-09-14T15:15:19.633+0000] {taskinstance.py:2191} INFO - Executing <Task(_PythonDecoratedOperator): detect_new_or_changed_rows> on 2024-09-13 00:00:00+00:00
[2024-09-14T15:15:19.643+0000] {standard_task_runner.py:60} INFO - Started process 1390 to run task
[2024-09-14T15:15:19.649+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'ETL_Dag_S3', 'detect_new_or_changed_rows', 'scheduled__2024-09-13T00:00:00+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/etl_dag_s3.py', '--cfg-path', '/tmp/tmp_si0ooev']
[2024-09-14T15:15:19.653+0000] {standard_task_runner.py:88} INFO - Job 12: Subtask detect_new_or_changed_rows
[2024-09-14T15:15:19.767+0000] {task_command.py:423} INFO - Running <TaskInstance: ETL_Dag_S3.detect_new_or_changed_rows scheduled__2024-09-13T00:00:00+00:00 [running]> on host 12663b3bf2f5
[2024-09-14T15:15:19.942+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='jasontran' AIRFLOW_CTX_DAG_ID='ETL_Dag_S3' AIRFLOW_CTX_TASK_ID='detect_new_or_changed_rows' AIRFLOW_CTX_EXECUTION_DATE='2024-09-13T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-09-13T00:00:00+00:00'
[2024-09-14T15:15:20.527+0000] {logging_mixin.py:188} INFO - Succesfully read data from AWS S3
[2024-09-14T15:15:20.529+0000] {connection.py:370} INFO - Snowflake Connector for Python Version: 3.6.0, Python Version: 3.8.18, Platform: Linux-5.15.146.1-microsoft-standard-WSL2-x86_64-with-glibc2.34
[2024-09-14T15:15:20.532+0000] {connection.py:1171} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-09-14T15:15:21.805+0000] {logging_mixin.py:188} INFO - Connected to Snowflake DWH succesfully
[2024-09-14T15:15:21.806+0000] {cursor.py:1028} INFO - query: [select * from ***_db.tcops_dimensions.employee_dim]
[2024-09-14T15:15:21.966+0000] {cursor.py:1041} INFO - query execution done
[2024-09-14T15:15:21.968+0000] {cursor.py:1205} INFO - Number of results in first chunk: 0
[2024-09-14T15:15:21.969+0000] {logging_mixin.py:188} INFO - Query executed
[2024-09-14T15:15:22.710+0000] {logging_mixin.py:188} INFO - Data fetched
[2024-09-14T15:15:22.711+0000] {connection.py:718} INFO - closed
[2024-09-14T15:15:23.175+0000] {connection.py:724} INFO - No async queries seem to be running, deleting session
[2024-09-14T15:15:23.271+0000] {logging_mixin.py:188} INFO - Columns renamed
[2024-09-14T15:15:23.420+0000] {logging_mixin.py:188} INFO - Found 1 new rows
[2024-09-14T15:15:23.435+0000] {logging_mixin.py:188} INFO - Found 2 changed rows
[2024-09-14T15:15:23.440+0000] {python.py:201} INFO - Done. Returned value was: {'rows_to_insert': "('Nguyen, Anh Dung', '001963', 'daniel.nguyen@truecommerce.com', 'Service Desk Consultant', 'Nguyen, Thuy Phuong Dung', 'DiCentral Vietnam', 'WeSupply', '650-Worldwide Support', 'Ho Chi Minh City', 'OneTime', '2024-08-05', NULL, '2024-09-14', NULL, 'Y'), ('Nguyen, Thi Hang', '950018', 'fiona.nguyen@truecommerce.com', 'Technical Support', 'Le, Minh Tam', 'DiCentral Vietnam', 'DiCentral', '650-Worldwide Support', 'Ho Chi Minh City', 'DIC - CIP Platform', '2022-11-10', NULL, '2024-09-14', NULL, 'Y'), ('Le, Vo Minh Triet', '001826', 'triet.le@truecommerce.com', 'Integration Engineer', 'Nguyen, Thanh Duy', 'DiCentral Vietnam', 'DiCentral', '610-Professional Services', 'Ho Chi Minh City', 'DIC - DiOMS', '2024-02-01', NULL, '2024-09-14', NULL, 'Y')", 'ids_to_update': "'950018', '001826'"}
[2024-09-14T15:15:23.541+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=ETL_Dag_S3, task_id=detect_new_or_changed_rows, execution_date=20240913T000000, start_date=20240914T151519, end_date=20240914T151523
[2024-09-14T15:15:23.609+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2024-09-14T15:15:23.671+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
